20190620：对can中断的所有操作与配置都要在时钟开启之后，否则无效。并且要对can2配置必须要先对can1进行配置，can1为主can，can2为从can
20190621：移植步进电机驱动代码，将驱动层和应用层进行剥离，改变优先级分组为分组4，即四位抢占，无响应。
        can发送为优先级4、5；can接受使用6、7、8、9；步进电机步数控制使用10；捕捉到位信号使用11;捕捉报警信号使用12；找零用13
		做测试，在跑步进电机任务的时候，进行can收发测试，10ms三万帧没有丢包
		
		
				 W25QXX_Write((u8*)TEXT_Buffer,FLASH_SIZE-100,sizeof(TEXT_Buffer));		//从倒数第100个地址处开始,写入SIZE长度的数据
			W25QXX_Read(datatemp,FLASH_SIZE-100,sizeof(TEXT_Buffer));					//从倒数第100个地址处开始,读出SIZE个字节
20190704：在CAndataDeal中添加了设备号的判断，如果接受设备的号码不是本设备，将不接受
20190705：发出预动命令之后，转轨器立刻回复一个上轨信号，有bug，应该是先回应，等到转轨正确之后才能发送上轨信号。
//*//记录并改正，原因：到位信号在post后没有及时的pend，导致其累加！！！！！
20190706：加速的速度过快，减小十倍//*//已经改正
20190707：定位时候最新的一天命令会覆盖中间的命令。
//*//已经解决，原因：内存释放的早了，所以每次都是申请的同一块内存，即使使用消息队列，队列中任然都会是同样的数据（最后一次更新的），使用memcpy后成功。
20190708：在执行小车移动任务的时候，校0任务会覆盖正在移动的任务，然后死机
//*//已解决：原因：没有对校零任务进行统一编链表，导致校零任务覆盖移动任务
/**/使用同一链表，将校零任务的结点放在转轨器移动链表中，正常。
20190709：添加丢步错误处理功能。丢步之后会鸣叫通知人工。
20190711：can发送中断中，当发送失败的时候，发送的消息邮箱是0，而消息邮箱中如果是0的话，就会被认为是等待不到，尽管已经判断出发送失败，然而任然需要等待最大
等待时间。修改，使用枚举变量返回不同的值。
20190712：添加串口初始化和字节发送功能，在开启发送中断后立刻进入中断，导致系统死机，查明原因，串口初始化之后 会发送一个空闲帧进行测试，导致进入中断
20190712：在串口中断函数中，对发送完成标志位进行清除，问题解决，可以正常发送。   添加modbus代码，考虑使用freemodbus
20190713：freemodbus太烦，自己写modbus，只使用03  06两个功能码。裸机103成功，未移植
20190714：应答帧在主从和多主没有区分开，应该做好区分。多主标志和主索引;已添加void ACKSendFram(u8 canChan,CAN_DATA_FRAME *tempNode)函数，该函数对发送回来的帧进行
判断，多主和主从会发送不同的应答帧；在帧解析函数会调用这个函数

20190715：测试改进的代码：01索引命令,获取转轨器状态 !!!!!!定义本机号是01
主从情况下0   结果帧id 04+本机设备号8位+16位索引；同；数据位是转轨器状态；
多主情况下1  结果帧id 14+接受设备地址+发送设备地址（本机）+8位索引；相同； 数据位是转轨器状态
 
    03获取转轨器配置 
主从情况下0   结果帧id 04+本机设备号8位+16位索引；同；数据位是转轨器状态；
多主情况下1  结果帧id 14+接受设备地址+发送设备地址（本机）+8位索引；相同； 数据位是转轨器状态
 
    05获取统计数据
主从情况下0   结果帧id 04+本机设备号8位+16位索引；同；数据位是转轨器状态；
多主情况下1  结果帧id 14+接受设备地址+发送设备地址（本机）+8位索引；相同； 数据位是转轨器状态

    fe预动任务  预动只有一次，只有当需要预动的流程执行完以后，才会接受下一条预动  预动任务只会是域发送给转轨器
①接受预动帧以后，立刻回应远程帧 ID：04+本机设备号8位+16位索引
②预动完成后回复结果帧：04+本机设备号8位+16位索引；数据位是错误和警告代码；
③当预动任务已经执行并且没有释放轨道锁：回复结果帧：04+本机设备号8位+16位索引；数据位是错误和警告代码（此时不再立刻回复应答帧）；

     11找零任务   在自动模式下只有域能让转轨器找零，也就是只有主从帧有效
①接受找零帧之后 立刻回复远程帧ID：04+本机设备号8位+16位索引
②找零结束后回复结果帧  ID：04+本机设备号8位+16位索引   数据位是错误代码




20190717：添加心跳任务，在没有给域发送帧的五秒之后，给域发送心跳帧，每隔5s发一次。      方案：使用定时器，对变量每隔1s++，开线程，当变量等于5的时候，
给域发送心跳帧，此处两种方案，是主动帧还是不需要应答的帧，都做。  在域帧发送函数中，对变量清零。
20190717:0x002D0044是目前使用的转轨器ARM识别号。添加回复回复唯一设备编号和canid的函数，测试成功。
20190717：添加根据唯一ARMID设置设备CANID的函数。  测试成功，需要注意，在改变设备ID后，要及时改变发送的帧ID，发送设备位应该随之改变，否则接受不到。
20190717：添加CAN通讯模式结构体，心跳帧发送功能可以正常关闭

20190718：对主从帧另起一个解析函数，通过主索引对各个帧进行分类，暂时仅有查询类，设置类，机械动作类；主从帧结构：00 xx 主索引自索引


20190722：改变CAN接受中断中的,对接受数据的长度的判断，防止接受不到远程帧。
